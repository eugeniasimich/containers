
\begin{code}

module FixCont where
open import Container renaming (map to mapc)
open import Data.Product
open import Data.Bool
open import Data.Unit
open import Data.Sum renaming ([_,_] to [_,_]ğ“¢et)
open import Function renaming (_âˆ˜_ to _âˆ˜Ì‚_ ; id to idâ‚›)--renaming (flip to fflip)
open Cont
open _â‡’_
\end{code}

\begin{code}
data Î¼ (C : Cont) : Set where
 âŸª_âŸ« : âŸ¦ C âŸ§ (Î¼ C) â†’ Î¼ C
\end{code}

\begin{code}
cTreeâ‚‚ : Set â†’ Cont
cTreeâ‚‚ A = Either (cK A) (Both cId cId)
\end{code}

\begin{code}
Treeâ‚‚ : Set â†’ Set
Treeâ‚‚ A = Î¼ (cTreeâ‚‚ A)

mapT : âˆ€{A B} â†’ (A â†’ B) â†’ Treeâ‚‚ A â†’ Treeâ‚‚ B
mapT f âŸª injâ‚ x , p âŸ« = âŸª (injâ‚ (f x) , (Î» { () })) âŸ«
mapT f âŸª injâ‚‚ (tt , tt) , p âŸ« = âŸª (injâ‚‚ (tt , tt) , (Î» { s â†’ mapT f (p s)})) âŸ«
\end{code}

\begin{code}
leafâ‚‚ : {A : Set} â†’ A â†’ Treeâ‚‚ A
leafâ‚‚ a = âŸª (injâ‚ a) , (Î» () ) âŸ«
\end{code}

\begin{code}
nodeâ‚‚ : {A : Set} â†’ Treeâ‚‚ A â†’ Treeâ‚‚ A â†’ Treeâ‚‚ A
nodeâ‚‚ l r = âŸª (injâ‚‚ (tt , tt)) , (Î»  {  (injâ‚ tt) â†’ r
                                     ;  (injâ‚‚ tt) â†’ l }) âŸ«
\end{code}
